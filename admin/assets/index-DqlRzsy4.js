import{j as e,F as x,C as h,B as N,r as o,T as se}from"./index-DRyvbuwC.js";import{P as ae}from"./PageBreadcrumb-DBJc5pYX.js";import{u as q,o as z,C as M,c as $,a as p}from"./index.esm-Bx1z_8dW.js";import{F as y}from"./FormTextInput-DRdrDswF.js";import{M as T,a as D,b as B,c as E}from"./Modal-DDkbE-ax.js";import{R as C}from"./Row-D8viwRQx.js";import{C as w,a as le}from"./Card-MnHSvN7k.js";import{u as F}from"./UserService-DpYplUIi.js";import{B as k}from"./Badge-iBrKrfKY.js";import"./PageMetaData-oL_TXYWw.js";import"./useWillUnmount-DkdTi-dN.js";import"./TransitionWrapper-6xtGNKQK.js";import"./AbstractModalHeader-Pq99qd0g.js";import"./hasClass-CxGT_UAX.js";import"./divWithClassName-B_Wsc-Ik.js";import"./CardHeaderContext-BWYyQX48.js";import"./httpClient-C-6Fvtai.js";const te=$().shape({name:p().required("Please enter name"),email:p().required("Please enter email").email(),role:p().required("Role is required"),password:p().required("Password is required").min(6),plan:p().required("Plan is required")}),ie=[{id:"Trial",name:"Trial",price:"0",icon:"mdi-star-outline",variant:"warning"},{id:"Premium",name:"Premium",price:"$499",icon:"mdi-certificate-outline",variant:"success"},{id:"Platinum",name:"Platinum",price:"$1899",icon:"mdi-diamond-stone",variant:"info"}],re=({show:v,onHide:c,onSubmit:j})=>{const{control:n,handleSubmit:d,reset:m,setValue:g,watch:r}=q({resolver:z(te),defaultValues:{name:"",email:"",role:"User",password:"",plan:"Trial"}}),l=r("plan"),t=a=>{j(a),m(),c()};return e.jsxs(T,{show:v,onHide:c,size:"xl",centered:!0,scrollable:!0,className:"fade",children:[e.jsx(D,{className:"bg-primary",closeButton:!0,children:e.jsxs("h6",{className:"modal-title m-0 text-white",children:[e.jsx("i",{className:"mdi mdi-account-plus me-2"}),"Add New User"]})}),e.jsx(B,{className:"p-4",children:e.jsx(x,{onSubmit:d(t),children:e.jsxs(C,{children:[e.jsxs(h,{lg:6,className:"border-end pe-lg-4",children:[e.jsx("h5",{className:"mt-0 header-title",children:"User Details"}),e.jsx("p",{className:"text-muted mb-4 font-13",children:"Enter the basic details for the new user account."}),e.jsx(y,{name:"name",label:"Full Name",placeholder:"John Doe",containerClass:"mb-3",control:n}),e.jsx(y,{name:"email",label:"Email Address",placeholder:"john@example.com",type:"email",containerClass:"mb-3",control:n}),e.jsx(y,{name:"password",label:"Password",placeholder:"******",type:"password",containerClass:"mb-3",control:n}),e.jsxs(x.Group,{className:"mb-3",children:[e.jsx(x.Label,{children:"Role"}),e.jsxs(x.Select,{className:"form-select",...n.register("role"),children:[e.jsx("option",{value:"User",children:"User"}),e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Manager",children:"Manager"})]})]})]}),e.jsxs(h,{lg:6,className:"ps-lg-4 mt-4 mt-lg-0",children:[e.jsxs("h5",{className:"mt-0 header-title d-flex align-items-center",children:[e.jsx("i",{className:"mdi mdi-layers-outline text-primary me-2 fs-4"}),"Choose Plan"]}),e.jsx("p",{className:"text-muted mb-4 font-13",children:"Select a subscription plan for this user."}),e.jsx(C,{className:"g-3",children:ie.map(a=>e.jsx(h,{sm:6,children:e.jsx(w,{className:`mb-0 shadow-none border cursor-pointer transition-all ${l===a.id?"border-primary bg-light bg-opacity-50":""}`,onClick:()=>g("plan",a.id),children:e.jsx(w.Body,{className:"p-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:`bg-soft-${a.variant} rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"40px",height:"40px"},children:e.jsx("i",{className:`mdi ${a.icon} fs-4 text-${a.variant}`})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"m-0 fw-bold",children:a.name}),e.jsx("span",{className:"text-primary fw-medium small",children:a.price==="0"?"Free":a.price})]}),l===a.id&&e.jsx("i",{className:"mdi mdi-check-circle text-primary fs-5"})]})})})},a.id))}),e.jsx(M,{name:"plan",control:n,render:({fieldState:a})=>a.error?e.jsx("div",{className:"text-danger small mt-2",children:a.error.message}):e.jsx(e.Fragment,{})})]})]})})}),e.jsxs(E,{className:"bg-light bg-opacity-50",children:[e.jsx(N,{variant:"de-secondary",size:"sm",onClick:c,children:"Cancel"}),e.jsx(N,{variant:"de-primary",size:"sm",onClick:d(t),children:"Create User"})]})]})},ne=$().shape({name:p().required("Please enter name"),email:p().required("Please enter email").email(),mobile:p().required("Mobile number is required"),password:p().optional(),plan:p().required("Plan selection is required")}),ce=[{id:"Trial",name:"Trial",price:"Free",icon:"mdi-star-outline",variant:"warning"},{id:"Premium",name:"Premium",price:"$499",icon:"mdi-certificate-outline",variant:"success"},{id:"Platinum",name:"Platinum",price:"$1899",icon:"mdi-diamond-stone",variant:"info"}],oe=({show:v,onHide:c,onSubmit:j,user:n})=>{const{control:d,handleSubmit:m,reset:g,setValue:r,watch:l}=q({resolver:z(ne),defaultValues:{name:"",email:"",mobile:"",password:"",plan:"Trial"}}),t=l("plan");o.useEffect(()=>{n&&g({name:n.name||"",email:n.email||"",mobile:n.mobile||n.ext||"",password:"",plan:n.plan||"Trial"})},[n,g]);const a=i=>{j(i),c()};return e.jsxs(T,{show:v,onHide:c,size:"xl",centered:!0,scrollable:!0,className:"fade",children:[e.jsx(D,{className:"bg-primary",closeButton:!0,children:e.jsxs("h6",{className:"modal-title m-0 text-white",children:[e.jsx("i",{className:"mdi mdi-account-edit me-2"}),"Edit User"]})}),e.jsx(B,{className:"p-4",children:e.jsx(x,{onSubmit:m(a),children:e.jsxs(C,{children:[e.jsxs(h,{lg:6,className:"border-end pe-lg-4",children:[e.jsx("h5",{className:"mt-0 header-title",children:"User Details"}),e.jsx("p",{className:"text-muted mb-4 font-13",children:"Update the user's personal and account information."}),e.jsx(y,{name:"name",label:"Full Name",placeholder:"John Doe",containerClass:"mb-3",control:d}),e.jsx(y,{name:"email",label:"Email Address",placeholder:"john@example.com",type:"email",containerClass:"mb-3",control:d}),e.jsx(y,{name:"mobile",label:"Mobile Number",placeholder:"085469 82450",containerClass:"mb-3",control:d}),e.jsx(y,{name:"password",label:"Password",placeholder:"******",type:"password",containerClass:"mb-1",control:d}),e.jsx("p",{className:"text-muted font-12 mb-3",children:"Ignore if you don't want to change the password."})]}),e.jsxs(h,{lg:6,className:"ps-lg-4 mt-4 mt-lg-0",children:[e.jsxs("h5",{className:"mt-0 header-title d-flex align-items-center",children:[e.jsx("i",{className:"mdi mdi-layers-outline text-primary me-2 fs-4"}),"Update Plan"]}),e.jsx("p",{className:"text-muted mb-4 font-13",children:"Choose a new plan to upgrade or downgrade user access."}),e.jsx(C,{className:"g-3",children:ce.map(i=>e.jsx(h,{sm:6,children:e.jsx(w,{className:`mb-0 shadow-none border cursor-pointer transition-all ${t===i.id?"border-primary bg-light bg-opacity-50":""}`,onClick:()=>r("plan",i.id),children:e.jsx(w.Body,{className:"p-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:`bg-soft-${i.variant} rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"40px",height:"40px"},children:e.jsx("i",{className:`mdi ${i.icon} fs-4 text-${i.variant}`})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"m-0 fw-bold",children:i.name}),e.jsx("span",{className:"text-primary fw-medium small",children:i.price})]}),t===i.id&&e.jsx("i",{className:"mdi mdi-check-circle text-primary fs-5"})]})})})},i.id))}),e.jsx(M,{name:"plan",control:d,render:({fieldState:i})=>i.error?e.jsx("div",{className:"text-danger small mt-2",children:i.error.message}):e.jsx(e.Fragment,{})})]})]})})}),e.jsxs(E,{className:"bg-light bg-opacity-50",children:[e.jsx(N,{variant:"de-secondary",size:"sm",onClick:c,children:"Cancel"}),e.jsx(N,{variant:"de-primary",size:"sm",onClick:m(a),children:"Save Changes"})]})]})},de=({onApply:v})=>{const[c,j]=o.useState([{fieldName:"Name",operator:"contains",value:"",logic:"and"}]),n=()=>{j([...c,{fieldName:"Name",operator:"contains",value:"",logic:"and"}])},d=r=>{const l=c.filter((t,a)=>a!==r);j(l)},m=(r,l,t)=>{const a=[...c],i={...a[r],[l]:t};l==="fieldName"&&(t==="Status"&&(i.operator="eq"),i.value=""),a[r]=i,j(a)},g=()=>{v(c.filter(r=>r.value))};return e.jsx(w,{className:"mb-3",children:e.jsxs(w.Body,{children:[e.jsx("h5",{className:"mb-3",children:"Advanced Filters"}),c.map((r,l)=>e.jsxs(C,{className:"mb-2 align-items-center",children:[e.jsx(h,{xs:"auto",style:{width:"100px"},children:l>0?e.jsxs(x.Select,{size:"sm",value:r.logic,onChange:t=>m(l,"logic",t.target.value),children:[e.jsx("option",{value:"and",children:"AND"}),e.jsx("option",{value:"or",children:"OR"})]}):e.jsx("span",{className:"d-block text-center text-muted small",children:"Where"})}),e.jsx(h,{children:e.jsxs(x.Select,{size:"sm",value:r.fieldName,onChange:t=>m(l,"fieldName",t.target.value),children:[e.jsx("option",{value:"Name",children:"Name"}),e.jsx("option",{value:"Email",children:"Email"}),e.jsx("option",{value:"PhoneNumber",children:"Phone"}),e.jsx("option",{value:"Role",children:"Role"}),e.jsx("option",{value:"Status",children:"Status"})]})}),e.jsx(h,{children:e.jsxs(x.Select,{size:"sm",value:r.operator,onChange:t=>m(l,"operator",t.target.value),children:[e.jsx("option",{value:"eq",children:"Equals"}),e.jsx("option",{value:"neq",children:"Not Equals"}),r.fieldName!=="Status"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"contains",children:"Contains"}),e.jsx("option",{value:"startswith",children:"Starts With"}),e.jsx("option",{value:"gt",children:"Greater Than"}),e.jsx("option",{value:"lt",children:"Less Than"})]})]})}),e.jsx(h,{children:r.fieldName==="Status"?e.jsxs(x.Select,{size:"sm",value:r.value,onChange:t=>m(l,"value",t.target.value),children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}):e.jsx(x.Control,{size:"sm",type:"text",placeholder:"Value...",value:r.value,onChange:t=>m(l,"value",t.target.value)})}),e.jsx(h,{xs:"auto",children:e.jsx(N,{variant:"outline-danger",size:"sm",onClick:()=>d(l),disabled:c.length===1,children:e.jsx("i",{className:"mdi mdi-delete"})})})]},l)),e.jsxs("div",{className:"mt-3",children:[e.jsxs(N,{variant:"outline-primary",size:"sm",className:"me-2",onClick:n,children:[e.jsx("i",{className:"mdi mdi-plus"})," Add Condition"]}),e.jsx(N,{variant:"primary",size:"sm",onClick:g,children:"Apply Filters"})]})]})})},Ae=()=>{const[v,c]=o.useState(!1),[j,n]=o.useState(!1),[d,m]=o.useState(null),[g,r]=o.useState([]),[l,t]=o.useState(!1),[a,i]=o.useState([]),[R,A]=o.useState(!1),[H,L]=o.useState(0),[I,V]=o.useState(0),f=o.useCallback(async(s,b,Q=1,X=10)=>{A(!0);try{const P=b||a,S=await F.searchUsers(s,P,Q,X),U=S.records||S,Y=S.totalRecords||U.length,Z=S.totalPages||0,ee=U.map(u=>({id:u.id,name:u.name,email:u.email,ext:u.phoneNumber,city:"Asia/Dubai",startDate:u.createdDate?new Date(u.createdDate).toLocaleDateString():"-",status:u.status==="Active"||u.status==="1"||u.status===1||u.status===!0,role:u.role,plan:"Standard"}));r(ee),L(Y),V(Z)}catch(P){console.error("Failed to fetch users",P)}finally{A(!1)}},[a]),G=async s=>{try{await F.createAgent(s),c(!1),f()}catch(b){console.error("Failed to create user",b)}},J=s=>{m(s),n(!0)},W=async s=>{try{await F.updateUser(s),n(!1),f()}catch(b){console.error("Failed to update user",b)}},_=async s=>{try{await F.toggleStatus(s),f()}catch(b){console.error("Failed to update status",b)}},O=[{Header:"Auto login",accessor:"auto_login",Cell:()=>e.jsx("button",{className:"btn btn-link p-0 border-0 shadow-none",children:e.jsx("i",{className:"mdi mdi-login-variant text-primary fs-4"})})},{Header:"Name",accessor:"name",defaultCanSort:!0,Cell:({row:s})=>e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"bg-light rounded-circle p-2 me-2 d-flex align-items-center justify-content-center",style:{width:"35px",height:"35px"},children:e.jsx("i",{className:"mdi mdi-account text-primary fs-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"fw-bold",children:[s.original.name,e.jsx(k,{bg:"info",className:"bg-opacity-10 text-info fw-bold px-2 py-0 ms-2",children:s.original.role||"User"})]}),e.jsx("div",{className:"text-muted small",children:s.original.email})]})]})},{Header:"Mobile",accessor:"ext",Cell:({value:s})=>e.jsx("span",{children:s})},{Header:"Timezone",accessor:"city",Cell:()=>e.jsx("span",{children:"Asia/Dubai"})},{Header:"Plan",accessor:"plan",Cell:()=>e.jsx(k,{bg:"success",className:"bg-opacity-10 text-success fw-bold px-2 py-1",children:"Premium"})},{Header:"Created Date",accessor:"startDate"},{Header:"Status",accessor:"status",Cell:({row:s})=>e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",id:`statusSwitch - ${s.original.id} `,checked:s.original.status,onChange:()=>_(s.original.id)})})},{Header:"Action",accessor:"action",disableSortBy:!0,Cell:({row:s})=>e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-de-primary shadow-none",onClick:()=>J(s.original),children:e.jsx("i",{className:"mdi mdi-pencil"})}),e.jsx("button",{className:"btn btn-sm btn-de-danger shadow-none",children:e.jsx("i",{className:"mdi mdi-trash-can"})})]})}],K=[{text:"5",value:5},{text:"10",value:10},{text:"25",value:25},{text:"All",value:g.length}];return e.jsxs(e.Fragment,{children:[e.jsx(ae,{title:"Manage User",subName:"Admin"}),e.jsx("div",{className:"text-end mb-3",children:e.jsxs(N,{variant:"de-primary",size:"sm",onClick:()=>c(!0),children:[e.jsx("i",{className:"mdi mdi-plus me-2"})," Create User"]})}),l&&e.jsx(de,{onApply:s=>{i(s),f(void 0,s)}}),e.jsx(C,{children:e.jsx(h,{xs:"12",children:e.jsx(w,{children:e.jsx(le,{children:e.jsx(se,{columns:O,data:g,pageSize:10,sizePerPageList:K,isSortable:!0,pagination:!0,isSearchable:!0,showToolbar:!0,onSearch:s=>f(s),onToggleAdvancedFilters:()=>t(!l),isLoading:R,isManualPagination:!0,totalRecords:H,pageCount:I,onPageChange:o.useCallback((s,b)=>{f(void 0,void 0,s,b)},[f])})})})})}),e.jsx(re,{show:v,onHide:()=>c(!1),onSubmit:G}),e.jsx(oe,{show:j,user:d,onHide:()=>n(!1),onSubmit:W})]})};export{Ae as default};
