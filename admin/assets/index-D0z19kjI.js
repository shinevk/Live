import{r as t,n,j as e,B as m,C,T as N,F as r}from"./index-CwmvLTAY.js";import{P as S}from"./PageBreadcrumb-C6Ll5pAH.js";import{s as d}from"./SubscriptionService-uNt4E045.js";import{R as w}from"./Row-DQJWrMMf.js";import{C as M,a as v}from"./Card-nCwNBMnw.js";import{M as l}from"./Modal-BRCer3fk.js";import"./PageMetaData-CgVBZ9tQ.js";import"./httpClient-C-6Fvtai.js";import"./CardHeaderContext-B_VJR2Kl.js";import"./divWithClassName-B6s3PHIC.js";import"./useWillUnmount-CdxlDIlz.js";import"./TransitionWrapper-BaRKeh_t.js";import"./AbstractModalHeader-C78Th97u.js";import"./hasClass-BdzqvN6r.js";import"./CloseButton-G5q851n-.js";import"./Fade-Dpp_DACu.js";const P=()=>{const[h,j]=t.useState([]),[b,u]=t.useState(!1),[f,o]=t.useState(!1),[s,p]=t.useState(null),i=t.useCallback(async a=>{u(!0);try{const c=await d.getModules(a);j(c||[])}catch{n.error("Failed to fetch modules")}finally{u(!1)}},[]);t.useEffect(()=>{i()},[i]);const g=async a=>{a.preventDefault();const c=new FormData(a.currentTarget),x=Object.fromEntries(c.entries());try{s!=null&&s.id?(await d.updateModule({...s,...x}),n.success("Module updated successfully")):(await d.createModule(x),n.success("Module created successfully")),o(!1),i()}catch{n.error("Operation failed")}},y=[{Header:"Module Name",accessor:"name"},{Header:"Description",accessor:"description"},{Header:"Icon",accessor:"iconKeyword",Cell:({value:a})=>e.jsx("i",{className:`mdi ${a} fs-4`})},{Header:"URL",accessor:"url",Cell:({value:a})=>a?e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-primary",children:a}):"-"},{Header:"Status",accessor:"status",Cell:({value:a})=>e.jsx("span",{className:`badge bg-opacity-10 ${a==="Active"?"bg-success text-success":"bg-danger text-danger"}`,children:a})},{Header:"Action",accessor:"id",Cell:({row:a})=>e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-de-primary shadow-none",onClick:()=>{p(a.original),o(!0)},children:e.jsx("i",{className:"mdi mdi-pencil"})}),e.jsx("button",{className:"btn btn-sm btn-de-danger shadow-none",onClick:()=>{window.confirm("Are you sure you want to delete this module?")&&d.deleteModule(a.original.id).then(()=>{n.success("Module deleted"),i()})},children:e.jsx("i",{className:"mdi mdi-trash-can"})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(S,{title:"Manage Modules",subName:"Admin"}),e.jsx("div",{className:"text-end mb-3",children:e.jsxs(m,{variant:"de-primary",size:"sm",onClick:()=>{p(null),o(!0)},children:[e.jsx("i",{className:"mdi mdi-plus me-2"})," Create Module"]})}),e.jsx(w,{children:e.jsx(C,{xs:"12",children:e.jsx(M,{children:e.jsx(v,{children:e.jsx(N,{columns:y,data:h,pageSize:10,isSortable:!0,pagination:!0,isSearchable:!0,showToolbar:!0,onSearch:i,isLoading:b})})})})}),e.jsxs(l,{show:f,onHide:()=>o(!1),centered:!0,children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:s?"Edit Module":"Add Module"})}),e.jsxs(r,{onSubmit:g,children:[e.jsxs(l.Body,{children:[e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Module Name"}),e.jsx(r.Control,{name:"name",defaultValue:s==null?void 0:s.name,required:!0,placeholder:"e.g. CRM"})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Description"}),e.jsx(r.Control,{name:"description",as:"textarea",defaultValue:s==null?void 0:s.description,required:!0})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Icon (MDI class)"}),e.jsx(r.Control,{name:"iconKeyword",defaultValue:s==null?void 0:s.iconKeyword,placeholder:"mdi-account-group"})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"URL"}),e.jsx(r.Control,{name:"url",type:"url",defaultValue:s==null?void 0:s.url,placeholder:"https://example.com/module"})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Status"}),e.jsxs(r.Select,{name:"status",defaultValue:(s==null?void 0:s.status)||"Active",children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]})]}),e.jsxs(l.Footer,{children:[e.jsx(m,{variant:"secondary",onClick:()=>o(!1),children:"Cancel"}),e.jsx(m,{variant:"primary",type:"submit",children:"Save Module"})]})]})]})]})};export{P as default};
