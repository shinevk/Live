import{r as l,u as x,j as e,d as p,A as S,e as T,s as B,C as F,L as G,B as H,n as f}from"./index-CwmvLTAY.js";import{P as L}from"./PageBreadcrumb-C6Ll5pAH.js";import{H as W}from"./httpClient-C-6Fvtai.js";import{a as E}from"./AIChatDataSourceService-Bz1LTWH6.js";import{R as $}from"./Row-DQJWrMMf.js";import{C as D,a as q}from"./Card-nCwNBMnw.js";import{d as z}from"./divWithClassName-B6s3PHIC.js";import{F as w}from"./Fade-Dpp_DACu.js";import{C as K}from"./CloseButton-G5q851n-.js";import"./PageMetaData-CgVBZ9tQ.js";import"./CardHeaderContext-B_VJR2Kl.js";import"./TransitionWrapper-BaRKeh_t.js";const v=z("h4");v.displayName="DivStyledAsH4";const A=l.forwardRef(({className:i,bsPrefix:s,as:a=v,...r},t)=>(s=x(s,"alert-heading"),e.jsx(a,{ref:t,className:p(i,s),...r})));A.displayName="AlertHeading";const y=l.forwardRef(({className:i,bsPrefix:s,as:a=S,...r},t)=>(s=x(s,"alert-link"),e.jsx(a,{ref:t,className:p(i,s),...r})));y.displayName="AlertLink";const k=l.forwardRef((i,s)=>{const{bsPrefix:a,show:r=!0,closeLabel:t="Close alert",closeVariant:c,className:u,children:n,variant:d="primary",onClose:m,dismissible:o,transition:j=w,...b}=T(i,{show:"onClose"}),h=x(a,"alert"),I=B(R=>{m&&m(!1,R)}),g=j===!0?w:j,N=e.jsxs("div",{role:"alert",...g?void 0:b,ref:s,className:p(u,h,d&&`${h}-${d}`,o&&`${h}-dismissible`),children:[o&&e.jsx(K,{onClick:I,"aria-label":t,variant:c}),n]});return g?e.jsx(g,{unmountOnExit:!0,...b,ref:void 0,in:r,children:N}):r?N:null});k.displayName="Alert";const C=Object.assign(k,{Link:y,Heading:A}),O={indexAll:async()=>(await W.post("/api/BotFlow/index-all")).data},ae=()=>{const[i,s]=l.useState(!1),[a,r]=l.useState(null),[t,c]=l.useState(null);l.useEffect(()=>{(async()=>{try{const m=(await E.getAll()).find(o=>o.isWorkflowKnowledgeBase&&!o.organizationId);c(!!m)}catch{c(!1)}})()},[]);const u=async()=>{s(!0),r(null);try{const n=await O.indexAll();r(n),n.success?f.success("Training started: "+n.message):f.error("Training failed: "+n.message)}catch(n){f.error("Network error occurred during training trigger"),r({success:!1,message:n.message||"Unknown error"})}finally{s(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"AI Training",subName:"Admin"}),e.jsx($,{className:"justify-content-center",children:e.jsx(F,{lg:8,children:e.jsx(D,{className:"shadow-sm border-0",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"avatar-xl bg-soft-primary rounded-circle mx-auto mb-3 d-flex align-items-center justify-content-center",children:e.jsx("i",{className:"mdi mdi-robot-industrial text-primary fs-1"})}),e.jsx("h4",{className:"fw-bold",children:"Workflow Intelligence Training"}),e.jsx("p",{className:"text-muted",children:'Trigger a global re-indexing of all production workflows and nodes. This "teaches" the AI generator how to build high-quality automations based on your existing data.'})]}),t===!1&&e.jsxs(C,{variant:"warning",className:"mb-4",children:[e.jsx("h6",{className:"alert-heading fw-bold",children:"Configuration Required"}),e.jsx("p",{className:"mb-2 small",children:'No Global AI Connection has been designated as the "Workflow Knowledge Base". Please configure this first to enable training.'}),e.jsx(G,{to:"/saas/global-ai-connections",className:"btn btn-sm btn-outline-warning fw-bold",children:"Go to Global Connections"})]}),e.jsxs("div",{className:"bg-light p-3 rounded mb-4",children:[e.jsx("h6",{className:"fw-semibold",children:"What happens during training?"}),e.jsxs("ul",{className:"text-muted small mb-0",children:[e.jsx("li",{children:"Extracts hierarchical structure from all active BotFlows."}),e.jsx("li",{children:"Generates vector embeddings for high-level workflow descriptions."}),e.jsx("li",{children:"Indexes individual node configurations (Zapier, AI, Conditions, etc.) as granular examples."}),e.jsx("li",{children:"Refreshes the RAG (Retrieval-Augmented Generation) cache for the Workflow Architect."})]})]}),a&&e.jsx(C,{variant:a.success?"success":"danger",className:"mb-4",children:e.jsxs("div",{className:"d-flex",children:[e.jsx("i",{className:`mdi ${a.success?"mdi-check-circle":"mdi-alert-circle"} fs-4 me-2`}),e.jsxs("div",{children:[e.jsx("h6",{className:"alert-heading fw-bold mb-1",children:a.success?"Indexing Successful":"Indexing Failed"}),e.jsx("p",{className:"mb-0 small",children:a.message})]})]})}),e.jsxs("div",{className:"d-grid gap-2",children:[e.jsx(H,{variant:"primary",size:"lg",onClick:u,disabled:i||t===!1,className:"fw-bold shadow-sm",children:i?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Indexing in Progress..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-brain me-2"}),"Train Global Workflow AI"]})}),e.jsxs("p",{className:"text-center text-muted x-small mt-2",children:[e.jsx("i",{className:"mdi mdi-information-outline me-1"}),"Large datasets may take several minutes to process."]})]})]})})})})]})};export{ae as default};
